{% extends "base.html" %}

{% block title %}QadamDapp — Главная{% endblock %}

{% block content %}
<section id="intro">
  <canvas id="starfield"></canvas>

  <div id="center-text">
    <span id="icon">
      <img src="{{ url_for('static', filename='logo/q.svg') }}" alt="icon" height="100" width="100" />
    </span>
    <span id="typed-text"></span>
  </div>
</section>

<section class="first-step-section">
  <div class="first-step-container">
    <div class="first-step-text">
      <h2>Твой первый шаг к профессии!</h2>
      <p>Найди профессию, которая тебе подходит, на основе твоих интересов, навыков и рынка труда Казахстана.</p>
    </div>
    <div class="first-step-img">
      <img src="{{ url_for('static', filename='logo/raketa.png') }}" alt="Первый шаг к профессии" />
    </div>
  </div>
</section>

<section class="fork-section">
  <div class="center-area">
    <div class="main-text">Твоя карьера — твой выбор</div>
    <button class="start-btn" id="startBtn">Начать</button>

    <svg class="branch-svg" id="branchSvg" viewBox="0 0 350 100">
      <path class="branch-path" d="M175,0 Q175,55 70,100" style="animation-delay:.1s;animation-play-state:paused"/>
      <path class="branch-path" d="M175,0 Q175,55 280,100" style="animation-delay:.25s;animation-play-state:paused"/>
    </svg>

    <div class="choice-row" id="choiceRow">
      <a class="choice-btn" href="{{ url_for('career') }}">AI навыки</a>
      <a class="choice-btn" href="{{ url_for('ai_tree') }}">Профориентация с AI</a>
    </div>
  </div>
</section>

<section class="benefits-section">
  <h2>Наши преимущества</h2>
  <div class="benefits-grid">
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/microchip-ai.png') }}" alt="ai">
      <div class="benefit-title">ИИ-анализ</div>
      <div class="benefit-desc">Используем GPT для анализа интересов и подбора рекомендаций.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/location.png') }}" alt="map">
      <div class="benefit-title">Адаптация под рынок РК</div>
      <div class="benefit-desc">Учитываем реальные вакансии и зарплаты Казахстана.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/bullseye-arrow(1).png') }}" alt="target">
      <div class="benefit-title">Индивидуальный подход</div>
      <div class="benefit-desc">Каждое решение — результат анализа твоих ответов.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/arrow-trend-up(1).png') }}" alt="up">
      <div class="benefit-title">Рост и успех</div>
      <div class="benefit-desc">Ты находишь профессию, где сможешь реализовать себя.</div>
    </div>
  </div>
</section>

<section class="stats-section" id="stats">
  <h2>Статистика</h2>
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-number" data-target="12840">0</div>
      <div class="stat-label">Студентов прошли тест</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" data-target="65">0</div>
      <div class="stat-label">Рекомендованных профессий</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" data-target="8200">0</div>
      <div class="stat-label">Совпадений с интересами</div>
    </div>
  </div>
</section>

<section class="partners-section" id="partners">
  <h2>Наши партнёры</h2>
  <div class="partners">
    <div class="partners-slider">
      <div class="partners-track bottom">
        <div class="partner-card"><img src="{{ url_for('static', filename='images/2.png') }}" alt="Partner 2"></div>
        <div class="partner-card"><img src="{{ url_for('static', filename='images/1.png') }}" alt="Partner 1"></div>
        <div class="partner-card"><img src="{{ url_for('static', filename='images/3.png') }}" alt="Partner 3"></div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  // Typed animation
  const typedText = document.getElementById('typed-text');
  if (typedText) {
    const text = 'adamDapp';
    let index = 0;
    (function typeWriter() {
      if (index < text.length) {
        typedText.innerHTML += text.charAt(index++);
        setTimeout(typeWriter, 150);
      } else {
        setTimeout(() => { typedText.innerHTML = ''; index = 0; typeWriter(); }, 5000);
      }
    })();
  }

  // Counters
  const statsSection = document.getElementById('stats');
  if (statsSection) {
    function animateCountUp(el, target, duration = 2000) {
      let start = 0;
      const step = Math.ceil(target / (duration / 20.7));
      const interval = setInterval(() => {
        start += step;
        if (start >= target) {
          el.textContent = target.toLocaleString() + '+';
          clearInterval(interval);
        } else {
          el.textContent = start.toLocaleString();
        }
      }, 16.7);
    }
    let statsAnimated = false;
    window.addEventListener('scroll', () => {
      const rect = statsSection.getBoundingClientRect();
      if (!statsAnimated && rect.top < window.innerHeight - 100) {
        document.querySelectorAll('.stat-number').forEach(el => {
          const target = parseInt(el.getAttribute('data-target'), 10);
          animateCountUp(el, target);
        });
        statsAnimated = true;
      }
    });
  }

  // Ветки и выбор
  const startBtn = document.getElementById('startBtn');
  const branchSvg = document.getElementById('branchSvg');
  const choiceRow = document.getElementById('choiceRow');
  const branchPaths = branchSvg ? branchSvg.querySelectorAll('.branch-path') : [];

  if (startBtn && branchSvg && choiceRow) {
    let branchesShown = false;
    startBtn.addEventListener('click', () => {
      if (branchesShown) return;
      branchesShown = true;
      branchSvg.classList.add('visible');
      branchPaths.forEach(path => path.style.animationPlayState = 'running');
      setTimeout(() => choiceRow.classList.add('visible'), 1100);
    });
  }
});
</script>
{% endblock %}
