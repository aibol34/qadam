{% extends "base.html" %}

{% block title %}QadamDapp ‚Äî –ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block content %}
<section id="intro">
  <canvas id="starfield"></canvas>

  <div id="center-text">
    <span id="icon">
      <img src="{{ url_for('static', filename='logo/q.svg') }}" alt="icon" height="100" width="100" />
    </span>
    <span id="typed-text"></span>
  </div>
</section>

<section class="first-step-section">
  <div class="first-step-container">
    <div class="first-step-text">
      <h2>–¢–≤–æ–π –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏!</h2>
      <p>–ù–∞–π–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ç–µ–±–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–≤–æ–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤, –Ω–∞–≤—ã–∫–æ–≤ –∏ —Ä—ã–Ω–∫–∞ —Ç—Ä—É–¥–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞.</p>
    </div>
    <div class="first-step-img">
      <img src="{{ url_for('static', filename='logo/raketa.png') }}" alt="–ü–µ—Ä–≤—ã–π —à–∞–≥ –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏" />
    </div>
  </div>
</section>

<section class="fork-section">
  <div class="center-area">
    <div class="main-text">–¢–≤–æ—è –∫–∞—Ä—å–µ—Ä–∞ ‚Äî —Ç–≤–æ–π –≤—ã–±–æ—Ä</div>
    <button class="start-btn" id="startBtn">–ù–∞—á–∞—Ç—å</button>

    <svg class="branch-svg" id="branchSvg" viewBox="0 -70 350 100">
      <path class="branch-path" d="M175,0 Q175,55 70,100" style="animation-delay:.1s;animation-play-state:paused"/>
      <path class="branch-path" d="M175,0 Q175,55 280,100" style="animation-delay:.25s;animation-play-state:paused"/>
    </svg>

    <div class="choice-row" id="choiceRow">
      <a class="choice-btn" href="{{ url_for('career') }}">AI –Ω–∞–≤—ã–∫–∏</a>
      <a class="choice-btn" href="{{ url_for('ai_tree') }}">–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è —Å AI</a>
    </div>
  </div>
</section>

<section class="benefits-section">
  <h2>–ù–∞—à–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h2>
  <div class="benefits-grid">
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/microchip-ai.png') }}" alt="ai">
      <div class="benefit-title">–ò–ò-–∞–Ω–∞–ª–∏–∑</div>
      <div class="benefit-desc">–ò—Å–ø–æ–ª—å–∑—É–µ–º GPT –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –∏ –ø–æ–¥–±–æ—Ä–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/location.png') }}" alt="map">
      <div class="benefit-title">–ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä—ã–Ω–æ–∫ –†–ö</div>
      <div class="benefit-desc">–£—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ –∑–∞—Ä–ø–ª–∞—Ç—ã –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/bullseye-arrow(1).png') }}" alt="target">
      <div class="benefit-title">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥</div>
      <div class="benefit-desc">–ö–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ —Ç–≤–æ–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤.</div>
    </div>
    <div class="benefit-card">
      <img class="benefit-icons" src="{{ url_for('static', filename='icons/arrow-trend-up(1).png') }}" alt="up">
      <div class="benefit-title">–†–æ—Å—Ç –∏ —É—Å–ø–µ—Ö</div>
      <div class="benefit-desc">–¢—ã –Ω–∞—Ö–æ–¥–∏—à—å –ø—Ä–æ—Ñ–µ—Å—Å–∏—é, –≥–¥–µ —Å–º–æ–∂–µ—à—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ–±—è.</div>
    </div>
  </div>
</section>

<section class="stats-section" id="stats">
  <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
  <div class="stats-grid">

    <div class="stat-card">
      <div class="stat-number" data-target="65">0</div>
      <div class="stat-label">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
    </div>

    <div class="stat-card">
      <div class="stat-number" data-target="12840">0</div>
      <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–æ—à–µ–¥—à–∏–µ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é</div>
    </div>

    <div class="stat-card">
      <div class="stat-number" data-target="8200">0</div>
      <div class="stat-label">–°–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –≤ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</div>
    </div>

  </div>
</section>


<section class="partners-section" id="partners">
  <h2>–ù–∞—à–∏ –ø–∞—Ä—Ç–Ω—ë—Ä—ã</h2>
  <div class="partners">
    <div class="partners-slider">
      <div class="partners-track bottom">
        <div class="partner-card"><img src="{{ url_for('static', filename='images/2.png') }}" alt="Partner 2"></div>
        <div class="partner-card"><img src="{{ url_for('static', filename='images/1.png') }}" alt="Partner 1"></div>
        <div class="partner-card"><img src="{{ url_for('static', filename='images/3.png') }}" alt="Partner 3"></div>
      </div>
    </div>
  </div>
</section>



{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
  // Typed animation
  const typedText = document.getElementById('typed-text');
  if (typedText) {
    const text = 'adamDapp';
    let index = 0;
    (function typeWriter() {
      if (index < text.length) {
        typedText.innerHTML += text.charAt(index++);
        setTimeout(typeWriter, 150);
      } else {
        setTimeout(() => { typedText.innerHTML = ''; index = 0; typeWriter(); }, 5000);
      }
    })();
  }

  // Counters
  const statsSection = document.getElementById('stats');
  if (statsSection) {
    function animateCountUp(el, target, duration = 2000) {
      let start = 0;
      const step = Math.ceil(target / (duration / 20.7));
      const interval = setInterval(() => {
        start += step;
        if (start >= target) {
          el.textContent = target.toLocaleString() + '+';
          clearInterval(interval);
        } else {
          el.textContent = start.toLocaleString();
        }
      }, 16.7);
    }
    let statsAnimated = false;
    window.addEventListener('scroll', () => {
      const rect = statsSection.getBoundingClientRect();
      if (!statsAnimated && rect.top < window.innerHeight - 100) {
        document.querySelectorAll('.stat-number').forEach(el => {
          const target = parseInt(el.getAttribute('data-target'), 10);
          animateCountUp(el, target);
        });
        statsAnimated = true;
      }
    });
  }

  // –í–µ—Ç–∫–∏ –∏ –≤—ã–±–æ—Ä
  const startBtn = document.getElementById('startBtn');
  const branchSvg = document.getElementById('branchSvg');
  const choiceRow = document.getElementById('choiceRow');
  const branchPaths = branchSvg ? branchSvg.querySelectorAll('.branch-path') : [];

  if (startBtn && branchSvg && choiceRow) {
    let branchesShown = false;
    startBtn.addEventListener('click', () => {
      if (branchesShown) return;
      branchesShown = true;
      branchSvg.classList.add('visible');
      branchPaths.forEach(path => path.style.animationPlayState = 'running');
      setTimeout(() => choiceRow.classList.add('visible'), 1100);
    });
  }
});
</script>




<!-- ================= QADAMDAPP CHAT ================= -->

<div id="chat-toggle">üí¨</div>

<div id="chat-widget" class="hidden">
  <div id="chat-header">
    <span>QadamDapp AI</span>
    <button id="new-chat-btn" title="–ù–æ–≤—ã–π —á–∞—Ç">üßπ</button>
  </div>

  <div id="chat-messages"></div>

  <div id="chat-input">
    <input type="text" id="chatText" placeholder="–°“±—Ä–∞“ì—ã“£—ã–∑–¥—ã –∂–∞–∑—ã“£—ã–∑..." />
    <button onclick="sendMessage()">‚û§</button>
  </div>
</div>

<script>

  document.addEventListener("DOMContentLoaded", () => {
    const toggleBtn = document.getElementById("chat-toggle");
    const chatWidget = document.getElementById("chat-widget");
    const newChatBtn = document.getElementById("new-chat-btn");
    const input = document.getElementById("chatText");
    const messages = document.getElementById("chat-messages");

    toggleBtn.onclick = () => chatWidget.classList.toggle("hidden");

    // –°—ã—Ä—Ç“õ–∞ –±–∞—Å“õ–∞–Ω–¥–∞ –∂–∞–±—ã–ª–∞–¥—ã
    document.addEventListener("click", (e) => {
      if (!chatWidget.contains(e.target) && !toggleBtn.contains(e.target)) {
        chatWidget.classList.add("hidden")
  ;</script
>


<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggleBtn = document.getElementById("chat-toggle");
  const chatWidget = document.getElementById("chat-widget");
  const newChatBtn = document.getElementById("new-chat-btn");
  const input = document.getElementById("chatText");
  const messages = document.getElementById("chat-messages");

  // –ê—à—ã–ø / –∂–∞–±—É
  toggleBtn.onclick = (e) => {
    e.stopPropagation();
    chatWidget.classList.toggle("hidden");
  };

  // –°—ã—Ä—Ç“õ–∞ –±–∞—Å—Å–∞ –∂–∞–±—ã–ª–∞–¥—ã
  document.addEventListener("click", (e) => {
    if (!chatWidget.contains(e.target) && !toggleBtn.contains(e.target)) {
      chatWidget.classList.add("hidden");
    }
  });

  // –ñ–∞“£–∞ —á–∞—Ç
  newChatBtn.onclick = () => {
    messages.innerHTML = "";
  };

  // –£–∞“õ—ã—Ç —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
  function getTime() {
    return new Date().toLocaleTimeString("kk-KZ", {
      hour: "2-digit",
      minute: "2-digit"
    });
  }

  // –ñ—ñ–±–µ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
  window.sendMessage = async function () {
    const text = input.value.trim();
    if (!text) return;

    // User —Ö–∞–±–∞—Ä–ª–∞–º–∞—Å—ã
    messages.innerHTML += `
      <div class="user">
        ${text}
        <div class="msg-time">${getTime()}</div>
      </div>
    `;
    input.value = "";
    messages.scrollTop = messages.scrollHeight;

    // Typing animation
    const typing = document.createElement("div");
    typing.className = "bot typing";
    typing.innerHTML = `<span></span><span></span><span></span>`;
    messages.appendChild(typing);
    messages.scrollTop = messages.scrollHeight;

    try {
      const res = await fetch("/assistant/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: text })
      });

      const data = await res.json();
      typing.remove();

      // Bot –∂–∞—É–∞–±—ã + —É–∞“õ—ã—Ç
      messages.innerHTML += `
        <div class="bot">
          ${data.reply}
          <div class="msg-time">${getTime()}</div>
        </div>
      `;
      messages.scrollTop = messages.scrollHeight;

    } catch (err) {
      typing.remove();
      messages.innerHTML += `<div class="bot" style="color:red">“ö–∞—Ç–µ —à—ã“õ—Ç—ã</div>`;
    }
  };

  // Enter –∞—Ä“õ—ã–ª—ã –∂—ñ–±–µ—Ä—É
  input.addEventListener("keydown", e => {
    if (e.key === "Enter") sendMessage();
  });
});
</script>





{% endblock %}
